# üìö –ó–∞–Ω—è—Ç–∏–µ ‚Ññ2: Cookie-Based Authentication (–ß–∞—Å—Ç—å 5)

## –ö–æ–º–º–∏—Ç: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏

---

## üéØ –ß—Ç–æ –º—ã –¥–µ–ª–∞–ª–∏

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –æ–±–Ω–æ–≤–∏–ª–∏ –Ω–∞–≤–±–∞—Ä, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –¥–∞—Ç—å –∞–¥–º–∏–Ω–∞–º —Ä–µ–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –ø—Ä—è–º–æ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

–î–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å JSON. –î–ª—è —ç—Ç–æ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –∑–Ω–∞–Ω–∏–µ Postman –∏–ª–∏ curl, –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ ID –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ç–µ–≥–æ–≤. –≠—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–ú—ã —Å–æ–∑–¥–∞–¥–∏–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é HTML-—Ñ–æ—Ä–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞, –æ—Ç–º–µ—á–∞—Ç—å —Ç–µ–≥–∏ —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å—ã, –≤–≤–æ–¥–∏—Ç—å —Ü–µ–Ω—ã –≤ –ø–æ–Ω—è—Ç–Ω—ã—Ö –ø–æ–ª—è—Ö. –≠—Ç–∞ —Ñ–æ—Ä–º–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–≤–∞–∂–¥—ã: –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö.

---

## üìù –î–∏–∑–∞–π–Ω —Ñ–æ—Ä–º—ã —Ç–æ–≤–∞—Ä–∞

–§–æ—Ä–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –ø–æ–ª—è –º–æ–¥–µ–ª–∏ Product: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –¥–≤–µ —Ü–µ–Ω—ã (–≤ shmeckles –∏ flurbos), URL –∫–∞—Ä—Ç–∏–Ω–∫–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ç–µ–≥–∏.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ç–µ–≥–∏ ‚Äî —ç—Ç–æ **–æ—Ç–Ω–æ—à–µ–Ω–∏—è** (relationships) –≤ –ë–î. Product —Å–≤—è–∑–∞–Ω —Å Category —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á `category_id`. Product —Å–≤—è–∑–∞–Ω —Å Tag —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É many-to-many `product_tag_association`. –ù–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –≤—ã–±–∏—Ä–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ UI, –∞ –±—ç–∫–µ–Ω–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–ª —Å–≤—è–∑–∏.

–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º `<select>` ‚Äî –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫. –û–Ω –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–µ—Ä–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –∞ –Ω–µ –≤–≤–µ–¥—ë—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç. –î–ª—è —Ç–µ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–µ–∫–±–æ–∫—Å—ã ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤ –∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ.

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ admin_product.html

–ú—ã —Å–æ–∑–¥–∞–ª–∏ —à–∞–±–ª–æ–Ω `templates/admin_product.html`. –≠—Ç–æ—Ç —Ñ–∞–π–ª –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `base.html`, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –µ–¥–∏–Ω—ã–π –Ω–∞–≤–±–∞—Ä –∏ —Å—Ç–∏–ª–∏.

–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º POST –Ω–∞ —Ç–æ—Ç –∂–µ URL, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –≠—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: GET –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É, POST –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ—ë. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ URL –±—É–¥–µ—Ç `/admin/products/new`, –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî `/admin/products/{id}/edit`.

Bootstrap –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Ñ–æ—Ä–º. `form-label` –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∏ –ø–æ–ª–µ–π —á–∏—Ç–∞–µ–º—ã–º–∏. `form-control` —Å—Ç–∏–ª–∏–∑—É–µ—Ç –ø–æ–ª—è –≤–≤–æ–¥–∞ (input, textarea, select). `mb-3` (margin-bottom: 3) –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É –ø–æ–ª—è–º–∏.

–ù–∞—á–Ω—ë–º —Å –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π:

```html
<div class="mb-3">
    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
    <input type="text" name="name" class="form-control" 
           value="{{ product.name if product else '' }}" required>
</div>
```

–ê—Ç—Ä–∏–±—É—Ç `name="name"` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ FormData. –ù–∞ –±—ç–∫–µ–Ω–¥–µ –º—ã –ø–æ–ª—É—á–∏–º —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `name: str = Form(...)`.

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `value="{{ product.name if product else '' }}"` ‚Äî —ç—Ç–æ Jinja2 —É—Å–ª–æ–≤–∏–µ. –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `product` –ø–µ—Ä–µ–¥–∞–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç), –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ï—Å–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è (`product` —Ä–∞–≤–µ–Ω `None`), –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ.

–ê—Ç—Ä–∏–±—É—Ç `required` –≤–∫–ª—é—á–∞–µ—Ç HTML5 –≤–∞–ª–∏–¥–∞—Ü–∏—é ‚Äî –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É —Å –ø—É—Å—Ç—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º.

---

## üí∞ –ü–æ–ª—è –¥–ª—è —Ü–µ–Ω

–¶–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ `Numeric(10, 2)` ‚Äî –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ —á–∏—Å–ª–∞ —Å –¥–≤—É–º—è –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –í HTML –∏—Å–ø–æ–ª—å–∑—É–µ–º `type="number"` —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º `step="0.01"`:

```html
<input type="number" name="price_shmeckles" step="0.01" 
       value="{{ product.price_shmeckles if product else '' }}" required>
```

–ê—Ç—Ä–∏–±—É—Ç `step="0.01"` —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤–≤–æ–¥ –∫–æ–ø–µ–µ–∫ (–∏–ª–∏ —Ü–µ–Ω—Ç–æ–≤). –ë–µ–∑ –Ω–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä –ø–æ–∑–≤–æ–ª—è–ª –±—ã –≤–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞. –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è —á–∏—Å–ª–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å —Ç–æ—á–∫–æ–π.

–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç: HTML-–∞—Ç—Ä–∏–±—É—Ç `min="0"` –º–æ–≥ –±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤–≤–æ–¥ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–Ω, –Ω–æ –º—ã –µ–≥–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –¥–æ–ø—É—Å—Ç–∏–º—ã –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–∫–∏–¥–∫–∏, –≤–æ–∑–≤—Ä–∞—Ç—ã). –í–∞–ª–∏–¥–∞—Ü–∏—é –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –≥–¥–µ –º–æ–∂–Ω–æ —É—á–µ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

---

## üñºÔ∏è –ü–æ–ª–µ –¥–ª—è URL –∫–∞—Ä—Ç–∏–Ω–∫–∏

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `type="url"` –¥–ª—è –ø–æ–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏:

```html
<input type="url" name="image_url" class="form-control">
```

HTML5 –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è `type="url"` —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –∑–Ω–∞—á–µ–Ω–∏–µ –±—ã–ª–æ –≤–∞–ª–∏–¥–Ω—ã–º URL: –Ω–∞—á–∏–Ω–∞–ª–æ—Å—å —Å `http://` –∏–ª–∏ `https://`. –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ, —Ñ–æ—Ä–º—É –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å.

–≠—Ç–æ —Å–æ–∑–¥–∞–ª–æ –ø—Ä–æ–±–ª–µ–º—É: —á—Ç–æ –µ—Å–ª–∏ —É —Ç–æ–≤–∞—Ä–∞ –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏? –ú—ã —Ö–æ—Ç–∏–º —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å –ø—É—Å—Ç—ã–º `image_url`, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–æ–∑–∂–µ.

–†–µ—à–µ–Ω–∏–µ ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –Ω–∞ `type="text"`:

```html
<input type="text" name="image_url" class="form-control" 
       value="{{ product.image_url if product else '' }}">
```

–¢–µ–ø–µ—Ä—å –±—Ä–∞—É–∑–µ—Ä –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç, –∏ –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ. –ù–∞ –±—ç–∫–µ–Ω–¥–µ –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ Pydantic, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –µ—Å–ª–∏ URL —É–∫–∞–∑–∞–Ω, —Ç–æ –æ–Ω –≤–∞–ª–∏–¥–µ–Ω).

–£–±–∏—Ä–∞–µ–º `required`, —á—Ç–æ–±—ã –ø–æ–ª–µ –±—ã–ª–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö `image_url` –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `nullable=True`, —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

## üìÇ –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

–ö–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî —ç—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ (internal –∫–ª—é—á). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω—É –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:

```html
<select name="category_id" class="form-select" required>
    {% for category in categories %}
        <option value="{{ category.id }}" 
                {% if product and product.category_id == category.id %}selected{% endif %}>
            {{ category.name }}
        </option>
    {% endfor %}
</select>
```

–ú—ã –∏—Ç–µ—Ä–∏—Ä—É–µ–º—Å—è –ø–æ —Å–ø–∏—Å–∫—É `categories`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞ –∏–∑ —Ä–æ—É—Ç–∞. –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–∑–¥–∞—ë–º `<option>` —Å `value="{{ category.id }}"` ‚Äî —ç—Ç–æ ID, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

–¢–µ–∫—Å—Ç –æ–ø—Ü–∏–∏ ‚Äî `{{ category.name }}` ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ù–∞–ø—Ä–∏–º–µ—Ä, "–ì–∞–¥–∂–µ—Ç—ã", "–û—Ä—É–∂–∏–µ", "–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã".

–£—Å–ª–æ–≤–∏–µ `{% if product and product.category_id == category.id %}selected{% endif %}` –¥–æ–±–∞–≤–ª—è–µ—Ç –∞—Ç—Ä–∏–±—É—Ç `selected` –∫ –æ–ø—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞ (–ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏). –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ–æ—Ä–º—É –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.

–ù–∞ –±—ç–∫–µ–Ω–¥–µ –º—ã –ø–æ–ª—É—á–∏–º `category_id` –∫–∞–∫ —Å—Ç—Ä–æ–∫—É (HTML –≤—Å—ë –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏), –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ int:

```python
category_id: str = Form(...)
category_id_int = int(category_id)
```

---

## üè∑Ô∏è –ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è —Ç–µ–≥–æ–≤

–¢–µ–≥–∏ ‚Äî —ç—Ç–æ many-to-many –æ—Ç–Ω–æ—à–µ–Ω–∏–µ. –û–¥–∏–Ω —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤, –æ–¥–∏–Ω —Ç–µ–≥ –º–æ–∂–µ—Ç –±—ã—Ç—å —É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ–º —á–µ–∫–±–æ–∫—Å—ã:

```html
{% for tag in tags %}
    <div class="form-check">
        <input type="checkbox" name="tag_ids" value="{{ tag.id }}" 
               class="form-check-input"
               {% if product and tag in product.tags %}checked{% endif %}>
        <label class="form-check-label">{{ tag.name }}</label>
    </div>
{% endfor %}
```

–í—Å–µ —á–µ–∫–±–æ–∫—Å—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ `name="tag_ids"`. –ö–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π –∏–º–µ—é—Ç –æ–¥–Ω–æ –∏–º—è, –±—Ä–∞—É–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –∫–∞–∫ –º–∞—Å—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–∏–π.

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª —Ç–µ–≥–∏ —Å ID 1, 3 –∏ 5, FormData –±—É–¥–µ—Ç:

```
tag_ids=1&tag_ids=3&tag_ids=5
```

–ù–∞ –±—ç–∫–µ–Ω–¥–µ FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç —ç—Ç–æ –≤ —Å–ø–∏—Å–æ–∫:

```python
tag_ids: list[int] = Form(default=[])
```

–ü–∞—Ä–∞–º–µ—Ç—Ä `default=[]` –≤–∞–∂–µ–Ω! –ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω —á–µ–∫–±–æ–∫—Å –Ω–µ –≤—ã–±—Ä–∞–Ω, –±—Ä–∞—É–∑–µ—Ä **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç** –ø–æ–ª–µ `tag_ids` –≤–æ–æ–±—â–µ. –ë–µ–∑ `default=[]` FastAPI –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ "field required".

–£—Å–ª–æ–≤–∏–µ `{% if product and tag in product.tags %}checked{% endif %}` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–≤—è–∑–∞–Ω –ª–∏ —Ç–æ–≤–∞—Ä —Å —ç—Ç–∏–º —Ç–µ–≥–æ–º. `product.tags` ‚Äî —ç—Ç–æ SQLAlchemy relationship, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤. –û–ø–µ—Ä–∞—Ç–æ—Ä `in` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–µ–≥–∞ –≤ —Å–ø–∏—Å–∫–µ.

---

## üé® –ö–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –æ—Ç–º–µ–Ω—ã

–í –∫–æ–Ω—Ü–µ —Ñ–æ—Ä–º—ã –¥–≤–µ –∫–Ω–æ–ø–∫–∏:

```html
<button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
<a href="/" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
```

–ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –∏–º–µ–µ—Ç `type="submit"` ‚Äî –æ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É. Bootstrap –∫–ª–∞—Å—Å `btn btn-primary` –¥–µ–ª–∞–µ—Ç –µ—ë —Å–∏–Ω–µ–π, —á—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

–ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∞" ‚Äî —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å—Å—ã–ª–∫–∞ `<a>`, —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–∞–∫ –∫–Ω–æ–ø–∫–∞ —á–µ—Ä–µ–∑ `btn btn-secondary`. –û–Ω–∞ –≤–µ–¥—ë—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `/`. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: "–û—Ç–º–µ–Ω–∞" –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç–æ—è—â–µ–π –∫–Ω–æ–ø–∫–æ–π —Ñ–æ—Ä–º—ã, –∏–Ω–∞—á–µ –æ–Ω–∞ –º–æ–≥–ª–∞ –±—ã —Å–ª—É—á–∞–π–Ω–æ submit —Ñ–æ—Ä–º—É.

–ö–ª–∞—Å—Å `btn-secondary` –¥–µ–ª–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å–µ—Ä–æ–π, –≤–∏–∑—É–∞–ª—å–Ω–æ –æ–±–æ–∑–Ω–∞—á–∞—è –µ—ë –∫–∞–∫ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

---

## üîÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Ñ–æ—Ä–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö –±–ª–∞–≥–æ–¥–∞—Ä—è —É—Å–ª–æ–≤–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º Jinja2.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (`GET /admin/products/new`):

```python
return templates.TemplateResponse("admin_product.html", {
    "request": request,
    "product": None,  # ‚Üê –í—Å–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ
    "categories": await get_all_categories(session),
    "tags": await get_all_tags(session)
})
```

–î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`GET /admin/products/{id}/edit`):

```python
product = await get_product_by_id(session, product_id)
return templates.TemplateResponse("admin_product.html", {
    "request": request,
    "product": product,  # ‚Üê –ü–æ–ª—è –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω—ã
    "categories": await get_all_categories(session),
    "tags": await get_all_tags(session)
})
```

Jinja2 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `{% if product %}` –≤ –∫–∞–∂–¥–æ–º –ø–æ–ª–µ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—É—Å—Ç—ã–º–∏.

–≠—Ç–æ DRY-–ø—Ä–∏–Ω—Ü–∏–ø (Don't Repeat Yourself) ‚Äî –º—ã –Ω–µ –¥—É–±–ª–∏—Ä—É–µ–º HTML –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –û–¥–Ω–∞ —Ñ–æ—Ä–º–∞, –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏.

---

## üí° –†–µ–∑—é–º–µ

–ú—ã —Å–æ–∑–¥–∞–ª–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É —Ç–æ–≤–∞—Ä–∞ –≤ `templates/admin_product.html`, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, –∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Bootstrap –∫–ª–∞—Å—Å—ã –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏, HTML5 –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –±–∞–∑–æ–≤–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏, Jinja2 —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π.

–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è: `type="text"` –≤–º–µ—Å—Ç–æ `type="url"` –¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏, `default=[]` –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ —Ç–µ–≥–æ–≤, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `category_id` –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤ int –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –∞—Ç—Ä–∏–±—É—Ç `selected` –¥–ª—è –ø—Ä–µ–¥–≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º POST –Ω–∞ —Ç–æ—Ç –∂–µ URL, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ä–æ—É—Ç—ã `/admin/products/new` –∏ `/admin/products/{id}/edit`, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç—É —Ñ–æ—Ä–º—É –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É.
