{% extends "base.html" %}

{% block title %}Погода в {{ city }} - Python419 Shop{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <!-- Карточка погоды -->
            <div class="card shadow-lg border-0">
                <div class="card-header bg-gradient text-white text-center py-3" 
                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h2 class="mb-0">
                        <i class="bi bi-cloud-sun"></i> Погода в {{ city }}
                    </h2>
                    <small class="opacity-75">Обновляется автоматически каждую минуту</small>
                </div>

                <!-- Контейнер для данных о погоде -->
                <div id="weather-container" style="position: relative;">
                    <!-- Индикатор загрузки -->
                    <div id="loading-indicator" class="htmx-indicator">
                        <div class="spinner-border text-white" role="status" style="width: 5rem; height: 5rem;">
                            <span class="visually-hidden">Загрузка...</span>
                        </div>
                        <p class="mt-3 text-white fw-bold">Обновление данных...</p>
                    </div>

                    <div id="weather-data" 
                         hx-get="/weather/data"
                         hx-trigger="load, every 300s"
                         hx-swap="innerHTML"
                         hx-indicator="#loading-indicator">
                        <!-- Данные будут загружены через HTMX -->
                        <div class="card-body text-center py-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Загрузка...</span>
                            </div>
                            <p class="mt-3 text-muted">Загрузка данных о погоде...</p>
                        </div>
                    </div>
                </div>

                <div class="card-footer text-center text-muted py-2">
                    <small>
                        <i class="bi bi-info-circle"></i> 
                        Данные предоставлены OpenWeatherMap
                    </small>
                </div>
            </div>

            <!-- Кнопка возврата на главную -->
            <div class="text-center mt-4">
                <a href="/" class="btn btn-outline-primary">
                    <i class="bi bi-house"></i> Вернуться на главную
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 15px;
        overflow: hidden;
    }
    
    .card-header {
        border: none;
    }
    
    .weather-icon {
        width: 120px;
        height: 120px;
        filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
    }
    
    .temp-display {
        font-size: 4rem;
        font-weight: 700;
        line-height: 1;
        color: #667eea;
    }
    
    .weather-detail {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1rem;
        margin: 0.5rem;
        transition: transform 0.2s;
    }
    
    .weather-detail:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .weather-detail i {
        font-size: 1.5rem;
        color: #667eea;
    }

    /* Индикатор загрузки HTMX */
    #loading-indicator {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(102, 126, 234, 0.95);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        backdrop-filter: blur(5px);
        animation: fadeIn 0.3s ease-in;
    }

    #loading-indicator.htmx-request {
        display: flex;
    }

    /* Затемнение контента во время загрузки */
    #weather-data.htmx-request {
        opacity: 0.3;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    /* Анимация вращения спиннера */
    .spinner-border {
        animation: spinner-border 0.75s linear infinite;
    }

    @keyframes spinner-border {
        to {
            transform: rotate(360deg);
        }
    }
</style>
{% endblock %}
